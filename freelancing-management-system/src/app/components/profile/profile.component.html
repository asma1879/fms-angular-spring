<div class="card shadow-sm profile-card"> <div class="card-body text-center"> 
  <!-- <img [src]="avatarPreview" class="rounded-circle mb-3 border border-success" width="100" height="100" alt="User" /> -->
  <!-- <img [src]="avatarPreview || 'http://localhost:8080/uploads/' + user?.avatar || 'https://i.pravatar.cc/150?img=5'" 
  class="rounded-circle mb-3 border border-success" width="100" height="100" alt="User" /> -->
  <!-- <img [src]="getAvatarUrl()"
  class="rounded-circle mb-3 border border-success"
  width="100" height="100" alt="User" /> -->
  <img 
  [src]="getAvatarUrl()"
  class="rounded-circle mb-3 border border-success"
  width="100" height="100"
  alt="User"
/>


   <div *ngIf="!editing"> 
    <h5>{{ user?.userName || user?.name || 'User' }}</h5> 
    <p class="text-muted">{{ user?.email }}</p>
     <span class="badge px-3 py-1 text-white" [ngClass]="getRoleBadgeClass()" style="text-transform: capitalize; font-size: 1rem;" >{{ user?.role || 'guest' }}</span>
    
      <div class="mt-3 d-grid gap-2">
      <p *ngIf="walletBalance !== null" class="text-success fw-bold mt-2">
  ðŸ’° Wallet Balance: ${{ walletBalance | number:'1.2-2' }}
</p>
   <button class="btn btn-sm btn-outline-primary" (click)="toggleEdit()">Edit</button> 
   <button class="btn btn-sm btn-outline-danger" (click)="logout()">Logout</button> </div> </div>

<form *ngIf="editing" (ngSubmit)="saveChanges()" class="text-start">
  <div class="mb-2">
    <label class="form-label">Username</label>
    <input type="text" class="form-control" [(ngModel)]="user.username" name="username">
  </div>
  <div class="mb-2">
    <label class="form-label">Email</label>
    <input type="email" class="form-control" [(ngModel)]="user.email" name="email">
  </div>
  <div class="mb-2">
    <label class="form-label">Password</label>
    <input type="password" class="form-control" [(ngModel)]="user.password" name="password">
  </div>
  <div class="mb-3">
    <label class="form-label">Avatar</label>
    <input type="file" class="form-control" (change)="onAvatarChange($event)">
  </div>
  <div class="d-grid gap-2">
    <button type="submit" class="btn btn-success">Save</button>
    <button type="button" class="btn btn-outline-secondary" (click)="toggleEdit()">Cancel</button>
  </div>
</form>
</div> </div>